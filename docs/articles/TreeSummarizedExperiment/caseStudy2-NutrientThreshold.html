<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="miaSim">
<title>Case study: Nutrient thresholds • miaSim</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Case study: Nutrient thresholds">
<meta property="og:description" content="miaSim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">miaSim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../articles/miaSim.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/TreeSummarizedExperiment/caseStudy1-SIS.html">Case study: SIS</a>
    <a class="dropdown-item" href="../../articles/TreeSummarizedExperiment/caseStudy2-NutrientThreshold.html">Case study: Nutrient thresholds</a>
    <a class="dropdown-item" href="../../articles/phyloseq/caseStudy1-SIS.html">caseStudy1-SIS</a>
    <a class="dropdown-item" href="../../articles/phyloseq/caseStudy2-NutrientThreshold.html">caseStudy2-NutrientThreshold</a>
    <a class="dropdown-item" href="../../articles/phyloseq/caseStudy3-EnvironmentalComplexity.html">caseStudy3-EnvironmentalComplexity</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/microbiome/miaSim/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="caseStudy2-NutrientThreshold_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Case study: Nutrient thresholds</h1>
                        <h4 data-toc-skip class="author">The miaSim package authors.</h4>
            
            <h4 data-toc-skip class="date">2023-05-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/microbiome/miaSim/blob/HEAD/vignettes/TreeSummarizedExperiment/caseStudy2-NutrientThreshold.Rmd" class="external-link"><code>vignettes/TreeSummarizedExperiment/caseStudy2-NutrientThreshold.Rmd</code></a></small>
      <div class="d-none name"><code>caseStudy2-NutrientThreshold.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="case-study-with-miasim-nutrient-concentration-threshold">Case study with miaSim: Nutrient concentration threshold<a class="anchor" aria-label="anchor" href="#case-study-with-miasim-nutrient-concentration-threshold"></a>
</h2>
<p>Reference: <a href="https://doi.org/10.1371/journal.pcbi.1006793" class="external-link">Available energy fluxes drive a transition in the diversity, stability, and functional structure of microbial communities</a>.</p>
<p>The aim of this case study is to design and demonstrate the existence of nutrient concentration threshold which limits the beta-diversity of communities.</p>
<p>To fulfill this aim, we designed a gradient of environments, as well as a gradient of communities.</p>
<div class="section level3">
<h3 id="load-dependencies">Load dependencies<a class="anchor" aria-label="anchor" href="#load-dependencies"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan" class="external-link">vegan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/microbiome/mia" class="external-link">mia</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/microbiome/miaSim" class="external-link">miaSim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/drostlab/philentropy" class="external-link">philentropy</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/cluster/" class="external-link">cluster</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load auxiliary functions from:</span></span>
<span><span class="co"># https://github.com/microbiome/miaSim/blob/main/vignettes/funcs.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"funcs.R"</span><span class="op">)</span> </span></code></pre></div>
<p>This batch of simulations is time-consuming. To reduce the calculation burden, we have decreased the numbers of environments, resources, and communities from the original 10 to 5, and made other minor modifications.</p>
</div>
<div class="section level3">
<h3 id="set-random-seed-and-initial-shared-parameters">Set random seed and initial shared parameters<a class="anchor" aria-label="anchor" href="#set-random-seed-and-initial-shared-parameters"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n_species</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">n_resources</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/randomE.html">randomE</a></span><span class="op">(</span><span class="va">n_species</span>, <span class="va">n_resources</span>, mean_consumption <span class="op">=</span> <span class="fl">1</span>, mean_production <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">growth_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_species</span><span class="op">)</span></span>
<span><span class="va">monod_constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">n_species</span><span class="op">*</span><span class="va">n_resources</span>, <span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,</span>
<span>                               nrow<span class="op">=</span><span class="va">n_species</span>,</span>
<span>                   ncol<span class="op">=</span><span class="va">n_resources</span><span class="op">)</span></span>
<span><span class="va">t_store</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">n.instances</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># no stochastic process: no need to repeat</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="initialization">Initialization<a class="anchor" aria-label="anchor" href="#initialization"></a>
</h3>
<p>Generate communities.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n.community</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co"># you can also try 20 or even 50.</span></span>
<span><span class="va">density.community</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="co"># Check the Rmd source file for gradient.df.generator function source code:</span></span>
<span><span class="co"># https://github.com/microbiome/miaSim/blob/main/vignettes/caseStudy2-NutrientThreshold.Rmd</span></span>
<span><span class="va">community.initial.df</span> <span class="op">&lt;-</span> <span class="fu">gradient.df.generator</span><span class="op">(</span>n_row <span class="op">=</span> <span class="va">n.community</span>,</span>
<span>                                              n_col <span class="op">=</span> <span class="va">n_species</span>,</span>
<span>                                              density_row <span class="op">=</span> <span class="va">density.community</span>,</span>
<span>                          max_gradient <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>                          error_interval <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## [1] 3</span></span>
<span><span class="co">## [1] 4</span></span>
<span><span class="co">## [1] 5</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist.community.initial.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span><span class="va">community.initial.df</span>, method <span class="op">=</span> <span class="st">"bray"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create TreeSummarizedExperiment object for the initial community</span></span>
<span><span class="va">community.initial.tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TreeSummarizedExperiment/man/TreeSummarizedExperiment-constructor.html" class="external-link">TreeSummarizedExperiment</a></span><span class="op">(</span>assays<span class="op">=</span><span class="fu">SimpleList</span><span class="op">(</span>abundances<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">community.initial.df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualze dissimilarities for the initial community</span></span>
<span><span class="fu">makeHeatmap</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">dist.community.initial.df</span><span class="op">)</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"dissimilarity matrix"</span>,</span>
<span>            x.label <span class="op">=</span> <span class="st">"community.1"</span>,</span>
<span>            y.label <span class="op">=</span> <span class="st">"community.2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="caseStudy2-NutrientThreshold_files/figure-html/gen-1.png" width="864"></p>
<p>Initialize shared parameters.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crm_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    n_species <span class="op">=</span> <span class="va">n_species</span>,</span>
<span>    n_resources <span class="op">=</span> <span class="va">n_resources</span>,</span>
<span>    x0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    E <span class="op">=</span> <span class="va">E</span>,</span>
<span>    resources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">n_resources</span><span class="op">)</span>,</span>
<span>    monod_constant <span class="op">=</span> <span class="va">monod_constant</span>,</span>
<span>    migration_p <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    stochastic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    t_start <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    t_end <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    t_step <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    t_store <span class="op">=</span> <span class="va">t_store</span>,</span>
<span>    growth_rates <span class="op">=</span> <span class="va">growth_rates</span>,</span>
<span>    norm<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Generate resource gradients.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resourceConcentration</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span> <span class="co"># 1 to 10000</span></span>
<span><span class="va">n.medium</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">density.medium</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="va">n_species</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">resource.initial.df</span> <span class="op">&lt;-</span> <span class="fu">gradient.df.generator</span><span class="op">(</span>n_row <span class="op">=</span> <span class="va">n.medium</span>,</span>
<span>    n_col <span class="op">=</span> <span class="va">n_resources</span>, density_row <span class="op">=</span> <span class="va">density.medium</span>,</span>
<span>    max_gradient <span class="op">=</span> <span class="fl">0.7</span>, error_interval <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## [1] 3</span></span>
<span><span class="co">## [1] 4</span></span>
<span><span class="co">## [1] 5</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="simulations">Simulations<a class="anchor" aria-label="anchor" href="#simulations"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pick the initial community</span></span>
<span><span class="va">initial.community</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">community.initial.tse</span>, <span class="st">"abundances"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">crmExample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/simulateConsumerResource.html">simulateConsumerResource</a></span><span class="op">(</span></span>
<span>    n_species <span class="op">=</span> <span class="va">n_species</span>,</span>
<span>    n_resources <span class="op">=</span> <span class="va">n_resources</span>,</span>
<span>    E <span class="op">=</span> <span class="va">E</span>,</span>
<span>    x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">initial.community</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="co"># First sample from the initial community</span></span>
<span>    resources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">resourceConcentration</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">resource.initial.df</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span>,</span>
<span>    growth_rates <span class="op">=</span> <span class="va">growth_rates</span>,</span>
<span>    monod_constant <span class="op">=</span> <span class="va">monod_constant</span>,</span>
<span>    stochastic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    t_end <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    t_step <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    t_store <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    norm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#makePlot(crmExample$matrix)</span></span>
<span><span class="va">tsem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mia/man/meltAssay.html" class="external-link">meltAssay</a></span><span class="op">(</span><span class="va">crmExample</span>, assay.type <span class="op">=</span> <span class="st">"counts"</span>, add_col_data <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tsem</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">counts</span>, color <span class="op">=</span> <span class="va">FeatureID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Species abundances by time"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="caseStudy2-NutrientThreshold_files/figure-html/grads2-1.png" width="864"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#makePlotRes(crmExample$resources)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">metadata</span><span class="op">(</span><span class="va">crmExample</span><span class="op">)</span><span class="op">$</span><span class="va">resources</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">crmExample</span><span class="op">)</span><span class="op">$</span><span class="va">time</span></span>
<span><span class="va">dft</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">df</span>, id<span class="op">=</span><span class="st">"time"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dft</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"resources"</span>, <span class="st">"S.t"</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dft</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">S.t</span>, col <span class="op">=</span> <span class="va">resources</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>show.legend <span class="op">=</span> <span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Quantity of compounds by time"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate simulations and store the final community in community.simulation</span></span>
<span><span class="co"># Here the final relative abundance table is basisComposition_prop.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">resourceConcentration</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span> <span class="co"># 1 to 10000</span></span>
<span><span class="va">n.medium</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="co"># make use of parallel computing provided by package `foreach`</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/foreach" class="external-link">foreach</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/doparallel" class="external-link">doParallel</a></span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span><span class="va">basisComposition</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>resConc <span class="op">=</span> <span class="va">resourceConcentration</span>, .combine <span class="op">=</span> <span class="va">rbind</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%:%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>medium <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n.medium</span><span class="op">)</span>, .combine <span class="op">=</span> <span class="va">rbind</span>, .packages <span class="op">=</span> <span class="st">"miaSim"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%dopar%</a></span> <span class="op">{</span></span>
<span>        <span class="va">crm_params</span><span class="op">$</span><span class="va">resources</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">resource.initial.df</span><span class="op">[</span><span class="va">medium</span>,<span class="op">]</span><span class="op">*</span><span class="va">resConc</span><span class="op">)</span></span>
<span>        <span class="va">paramx0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">community.initial.df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">crm_param_iter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x0 <span class="op">=</span> <span class="va">paramx0</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"resConc"</span>, <span class="va">resConc</span>, <span class="st">"medium"</span>, <span class="va">medium</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">crmMoments</span> <span class="op">&lt;-</span> <span class="fu">miaSim</span><span class="fu">::</span><span class="fu"><a href="../../reference/generateSimulations.html">generateSimulations</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"simulateConsumerResource"</span>,</span>
<span>                                           params_list <span class="op">=</span> <span class="va">crm_params</span>,</span>
<span>                                           param_iter <span class="op">=</span> <span class="va">crm_param_iter</span>,</span>
<span>                                           n_instances <span class="op">=</span> <span class="va">n.instances</span>,</span>
<span>                                           t_end <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span>        <span class="co"># pick community composition at the last time point       </span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">crmMoments</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"counts"</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span>
<span><span class="va">basisComposition_prop</span> <span class="op">&lt;-</span> <span class="va">basisComposition</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">basisComposition</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-umap-plots">Make UMAP plots<a class="anchor" aria-label="anchor" href="#make-umap-plots"></a>
</h3>
<p>In this step, plot result is stored in umap_CRM_gradient_plot, and this is visualized in different facets.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resourceConcentration</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span> <span class="co"># 1 to 10000</span></span>
<span><span class="va">n.medium</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">n.community</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">concentration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">resourceConcentration</span>, each <span class="op">=</span> <span class="va">n.medium</span><span class="op">*</span><span class="va">n.community</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">medium</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n.medium</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n.community</span> ,times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">resourceConcentration</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">community</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n.community</span><span class="op">)</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">resourceConcentration</span><span class="op">)</span><span class="op">*</span><span class="va">n.medium</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize with UMAP </span></span>
<span></span>
<span><span class="co">## Provide the community data as TreeSE object</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/" class="external-link">scater</a></span><span class="op">)</span></span>
<span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TreeSummarizedExperiment/man/TreeSummarizedExperiment-constructor.html" class="external-link">TreeSummarizedExperiment</a></span><span class="op">(</span></span>
<span>                assays<span class="op">=</span><span class="fu">SimpleList</span><span class="op">(</span>abundances<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">basisComposition</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        colData<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>Medium<span class="op">=</span><span class="va">medium</span>,</span>
<span>                              Concentration<span class="op">=</span><span class="va">concentration</span>,</span>
<span>                      Community<span class="op">=</span><span class="va">community</span></span>
<span>                      <span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span><span class="co">## Add UMAP</span></span>
<span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runUMAP.html" class="external-link">runUMAP</a></span><span class="op">(</span><span class="va">tse</span>, name <span class="op">=</span> <span class="st">"UMAP"</span>, exprs_values <span class="op">=</span> <span class="st">"abundances"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot UMAP</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/plotReducedDim.html" class="external-link">plotReducedDim</a></span><span class="op">(</span><span class="va">tse</span>, <span class="st">"UMAP"</span>, colour_by<span class="op">=</span><span class="st">"Medium"</span>, shape_by<span class="op">=</span><span class="st">"Concentration"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Same for compositional abundance data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/microbiome/mia" class="external-link">mia</a></span><span class="op">)</span></span>
<span><span class="co">## add relative abundances;</span></span>
<span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mia/man/transformCounts.html" class="external-link">transformSamples</a></span><span class="op">(</span><span class="va">tse</span>, assay.type<span class="op">=</span><span class="st">"abundances"</span>, method<span class="op">=</span><span class="st">"relabundance"</span><span class="op">)</span></span>
<span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/runUMAP.html" class="external-link">runUMAP</a></span><span class="op">(</span><span class="va">tse</span>, name <span class="op">=</span> <span class="st">"UMAP_compositional"</span>, exprs_values <span class="op">=</span> <span class="st">"relabundance"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/plotReducedDim.html" class="external-link">plotReducedDim</a></span><span class="op">(</span><span class="va">tse</span>, <span class="st">"UMAP_compositional"</span>, colour_by<span class="op">=</span><span class="st">"Medium"</span>, shape_by<span class="op">=</span><span class="st">"Concentration"</span><span class="op">)</span></span>
<span><span class="co"># Finally with communities</span></span>
<span><span class="va">umap_CRM_gradient_plot</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scater/man/plotReducedDim.html" class="external-link">plotReducedDim</a></span><span class="op">(</span><span class="va">tse</span>, <span class="st">"UMAP_compositional"</span>,</span>
<span>   colour_by<span class="op">=</span><span class="st">"Medium"</span>, shape_by<span class="op">=</span><span class="st">"Community"</span>, size_by<span class="op">=</span><span class="st">"Concentration"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization-of-the-results">Visualization of the results<a class="anchor" aria-label="anchor" href="#visualization-of-the-results"></a>
</h3>
<p>In this part, different visualization of results demonstrate (in various facets) the gradual change of communities’ beta diversity. The first figure indicates that the initial community composition is more important than the combinations of initial available resources.</p>
<p>The first sub-figure in the second figure demonstrates that in an oligotrophic (less available nutrients) environment, communities won’t change much in a given time, whilst the last two sub-figures resemble each other, implying that the nutrient is no longer the limiting factor of the beta-diversity of the community. This pattern is further displayed in the following “curve plot”.</p>
<p>In the third figure, the second and the th community always stays more similar, despite their initial dissimilarity, indicating that they might belong to one community type. This can be validated by input 20 or even 50 as n.community in this case study: communities turns into clusters in each sub-figures.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># FIXME: the visual output can be polished later.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">umap_CRM_gradient_plot</span><span class="op">)</span></span>
<span><span class="va">umap_CRM_gradient_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">size_by</span> <span class="op">~</span> <span class="va">.</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span>
<span><span class="va">umap_CRM_gradient_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">colour_by</span> <span class="op">~</span> <span class="va">size_by</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span>
<span><span class="va">umap_CRM_gradient_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">shape_by</span> <span class="op">~</span> <span class="va">size_by</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span>
<span><span class="va">umap_CRM_gradient_plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">shape_by</span> <span class="op">~</span> <span class="va">colour_by</span>, labeller <span class="op">=</span> <span class="va">label_both</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Yagmur Simsek, Karoline Faust, Yu Gao, Emma Gheysen, Daniel Rios Garza, Tuomas Borman, Leo Lahti.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
